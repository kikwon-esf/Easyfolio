<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 해당 파일에 모든 쿼리문을 작성 -->
<mapper namespace="cscMapper">

    <!--  공지사항  -->

    <resultMap id="announcement" type="com.easyfolio.esf.csc.vo.AnnVO">
        <id column="ANN_NUM" property="annNum" />
        <result column="ANN_CATE" property="annCate" />
        <result column="ANN_WRITER" property="annWriter" />
        <result column="ANN_TITLE" property="annTitle" />
        <result column="ANN_CONTENT" property="annContent"/>
        <result column="ANN_DATE" property="annDate"/>
        <collection property="annCateList" resultMap="annCate"/>
    </resultMap>

    <resultMap id="annCate" type="com.easyfolio.esf.csc.vo.AnnCateVO">
        <id column="CATE_CODE" property="cateCode"/>
        <result column="CATE_NAME" property="cateName"/>
    </resultMap>

    <!--  공지사항 메인 페이지 조회  -->
    <select id="mainAnnList" resultMap="announcement">
        SELECT ANN_NUM
        , ANN_CATE
        , CATE_NAME
        , ANN_TITLE
        , ANN_CONTENT
        , TO_CHAR(ANN_DATE,'YYYY-MM-DD') AS ANN_DATE
        FROM ANNOUNCEMENT ANN, ANN_CATE_LIST LIST
        WHERE ANN.ANN_CATE = LIST.CATE_CODE
        ORDER BY ANN_NUM DESC
        OFFSET 0 ROWS FETCH FIRST 4 ROWS ONLY
    </select>

    <!--  공지사항 목록 조회  -->
    <select id="annList" resultMap="announcement">
        SELECT ANN_NUM
            , ANN_CATE
            , CATE_NAME
            , ANN_TITLE
            , ANN_CONTENT
            , TO_CHAR(ANN_DATE,'YYYY-MM-DD') AS ANN_DATE
        FROM ANNOUNCEMENT ANN, ANN_CATE_LIST LIST
        WHERE ANN.ANN_CATE = LIST.CATE_CODE
        ORDER BY ANN_NUM DESC
        OFFSET 0 ROWS FETCH FIRST 10 ROWS ONLY
    </select>

    <!--  공지 사항 세부 조회  -->
    <select id="annDetail" resultMap="announcement">
        SELECT ANN_NUM
            , CATE_CODE
            , CATE_NAME
            , ANN_WRITER
            , ANN_TITLE
            , ANN_CONTENT
            , TO_CHAR(ANN_DATE, 'YYYY-MM-DD') AS ANN_DATE
        FROM ANNOUNCEMENT ANN, ANN_CATE_LIST LIST
        WHERE ANN.ANN_CATE = LIST.CATE_CODE
        AND ANN_NUM = #{annNum}
    </select>

    <!--  공지 사항 작성  -->
    <insert id="insertAnn">
        INSERT INTO ANNOUNCEMENT (
        ANN_NUM
        , ANN_CATE
        , ANN_TITLE
        , ANN_CONTENT
        )
        VALUES (
        (SELECT 'ANN_' ||LPAD(NVL(MAX(TO_NUMBER(SUBSTR(ANN_NUM, 5))),0) + 1, 3, '0')
        FROM ANNOUNCEMENT)
        , #{annCate}
        , #{annTitle}
        , #{annContent}
        )
    </insert>

    <update id="updateAnn">
        UPDATE ANNOUNCEMENT
        SET
        ANN_CATE = #{annCate}
        , ANN_TITLE = #{annTitle}
        , ANN_CONTENT = #{annContent}
        WHERE ANN_NUM = #{annNum}
    </update>

    <delete id="deleteAnn">
        DELETE ANNOUNCEMENT
        WHERE ANN_NUM = #{annNum}
    </delete>

    <!--  문의 사항  -->

<!--    <resultMap id="inquire" type="com.easyfolio.esf.csc.vo.InqVO" >-->
<!--        <id column="INQ_CODE" property="inqCode"/>-->
<!--        <result column="CATE_CODE" property="cateCode"/>-->
<!--        <result column="MEMBER_ID" property="memberId"/>-->
<!--        <result column="TITLE" property="title"/>-->
<!--        <result column="CONTENT" property="content"/>-->
<!--        <result column="IS_RESPONSE" property="isResponse"/>-->
<!--        <result column="INQ_DATE" property="inqDate"/>-->
<!--        <collection property="inqCateList" resultMap="inqCate"/>-->
<!--        <collection property="inqImgList" resultMap="inqImg"/>-->
<!--        <collection property="member" resultMap="memberMapper.member"/>-->
<!--    </resultMap>-->

<!--    <resultMap id="inqCate" type="com.easyfolio.esf.csc.vo.InqCateVO">-->
<!--        <id column="CATE_CODE" property="cateCode"/>-->
<!--        <result column="CATE_NAME" property="cateName"/>-->
<!--    </resultMap>-->

<!--    <resultMap id="inqImg" type="com.easyfolio.esf.csc.vo.InqImgVO">-->
<!--        <id column="IMG_CODE" property="imgCode"/>-->
<!--        <result column="ORIGIN_FILE_NAME" property="originFileName"/>-->
<!--        <result column="ATTACHED_FILE_NAME" property="attachedFileName"/>-->
<!--        <result column="INQ_CODE" property="inqCode"/>-->
<!--    </resultMap>-->



</mapper>































